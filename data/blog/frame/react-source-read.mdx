---
title: 'React æºç ï¼ˆåŸºäº v18.2.0ï¼‰'
date: '2024-07-31 18:23:18'
# lastmod: '1900-01-01'
tags: ['react']
draft: true
summary: "ä¹Ÿæ˜¯ä¸€ä¸ª React ä½¿ç”¨äº† 4 å¹´çš„é€‰æ‰‹äº†ï¼Œæƒ³å½“å‡ºè‡ªå·±å’¬ç‰™å•ƒ React æºç ä¸€çŸ¥åŠè§£ï¼Œåæ¥çœ‹äº†å¾ˆå¤šå¤§ä½¬çš„æ–‡ç« é¢‡æœ‰æ”¶è·ï¼Œå¿™é‡Œå·é—²ï¼Œæ¸©æ•…è€ŒçŸ¥æ–°ä¸€ä¸‹ä¸‹ï¼Œlet's goğŸ§¨"
images: []
layout: PostLayout
---

## Overview

<TOCInline toc={props.toc} exclude="Overview" toHeading={2} />

---

## å‰ç½®

- [ä½è¿ç®—](https://www.twotwoba.site/blog/algorithm/bit-operation#%E8%BF%9B%E9%98%B6%E6%8A%80%E5%B7%A7)ï¼ŒReact æºç ä¸­å­˜åœ¨å¤§é‡ä½è¿ç®—ï¼Œå»ºè®®å…ˆçœ‹çœ‹
- [ä¼˜å…ˆé˜Ÿåˆ—](https://www.twotwoba.site/blog/algorithm/priority-queue)ï¼ŒReact è°ƒåº¦ç®—æ³•ä¸­ä½¿ç”¨äº†å°é¡¶å †
- [React è°ƒè¯•æºç æŠ€å·§](https://www.twotwoba.site/blog/frame/react-source-debug)ï¼Œäº²è‡ªè°ƒè¯•ï¼Œæ‰èƒ½å°è±¡æ·±åˆ»å“¦

## å®è§‚åŸºç¡€æ¦‚å¿µ

å››ä¸ªå…³é”®åŒ…ï¼š
- `react`ï¼Œå¯¹å¤–æš´éœ² APIï¼Œåªæä¾›å®šä¹‰ react ç»„ä»¶çš„å¿…è¦å‡½æ•°ï¼Œå¦‚ `ReactElement`
- `react-dom`ï¼Œæ¸²æŸ“å™¨ï¼Œæ‰¿æ‹…`å¯åŠ¨ react æ¸²æŸ“æµç¨‹`å’Œ`æŠŠ reconciler æ„é€ å‡ºæ¥çš„ fiber æ ‘è¡¨ç°å‡ºæ¥çš„`ä½œç”¨ï¼ˆç”Ÿæˆ dom èŠ‚ç‚¹(æµè§ˆå™¨ä¸­), ç”Ÿæˆå­—ç¬¦ä¸²(ssr)ï¼‰
- `react-reconciler`ï¼Œç»¼åˆåè°ƒå¦å¤–ä¸‰ä¸ªåŒ…
    - æ¥æ”¶ `react-dom` ï¼ˆåˆæ¬¡ renderï¼‰ å’Œ `react` ï¼ˆåç»­ setStateï¼‰ å¼•èµ·çš„æ›´æ–°
    - æŠŠæ„é€  fiber æ ‘çš„è¿‡ç¨‹åŒ…è£…åœ¨ä¸€ä¸ªå›è°ƒå‡½æ•°ä¸­ï¼Œå¹¶å°†æ­¤å›è°ƒå‡½æ•°ä¼ å…¥ `scheduler` ç­‰å¾…è°ƒåº¦ã€‚å›è°ƒå‡½æ•°ï¼š`performSyncWorkOnRoot/performConcurrentWorkOnRoot`
- `scheduler`ï¼Œé¡¾åæ€ä¹‰è¿™ä¸ªåŒ…èµ·åˆ°äº†è°ƒåº¦çš„ä½œç”¨ï¼Œæ§åˆ¶ç€ä» `reconciler` ä¼ å…¥çš„å›è°ƒå‡½æ•°çš„æ‰§è¡Œæ—¶æœºï¼Œ`concurrent` æ¨¡å¼ä¸‹å¯ä»¥å®ç°ä»»åŠ¡åˆ†ç‰‡

---

## å¯åŠ¨è¿‡ç¨‹

![createRoot](/static/images/react/ReactDomRoot.png)

ä¸Šå›¾æ˜¯ä¸€ä¸ª React é¡¹ç›®å¯åŠ¨çš„åŸºæœ¬æµç¨‹ï¼Œé€šè¿‡è°ƒè¯•æºç ï¼Œç†è§£èµ·æ¥ç›¸å¯¹è¾ƒå®¹æ˜“ã€‚

- `createRoot`ï¼Œä¸»è¦ä½¿å‘½åˆ›å»ºäº† `FiberRoot` å’Œ `HostFiberRoot`ï¼Œä¸¤è€…çš„è¿æ¥è§å›¾
    - `FiberRoot` ä¸»è¦å­˜å‚¨äº†æ„å»º `Fiber` è¿‡ç¨‹ä¸­çš„å…¨å±€çŠ¶æ€
    - `HostRootFiber` æ˜¯ç¬¬ä¸€ä¸ª `Fiber` èŠ‚ç‚¹ï¼Œ`markContainerAsRoot` å°†å®ƒå’Œ `container` å…³è”èµ·æ¥äº†
- `render`ï¼Œæ˜¯ `ReactDOMRoot` å¯¹è±¡åŸå‹ä¸Šçš„æ–¹æ³•ï¼Œå†…éƒ¨è°ƒç”¨äº† `updateContainer` è¿›å…¥ `reconciler` æµç¨‹


ç›®å‰ï¼Œæˆ‘ä»¬æ¸…æ¥šçš„çŸ¥é“ `react-dom` åŒ…ä½œä¸º**æ¸²æŸ“å™¨**åˆå§‹å¯åŠ¨çš„å¤§ä½“æµç¨‹ã€‚

## åè°ƒè¿‡ç¨‹

`scheduler`

## è°ƒåº¦è¿‡ç¨‹

## æ¨èåšæ–‡

- [dan abramov çš„åšå®¢](https://overreacted.io/)
- [React æŠ€æœ¯æ­ç§˜](https://react.iamkasong.com/)
- [å›¾è§£ React](https://7km.top/)

