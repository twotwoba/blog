---
title: 'ä¼˜å…ˆé˜Ÿåˆ—'
summary: 'react è°ƒåº¦ç®—æ³•ä½¿ç”¨çš„å°é¡¶å † minHeap å°±æ˜¯ä¸€ä¸ªä¼˜å…ˆé˜Ÿåˆ—.'
date: '2022-10-25'
tags: ['data structure']
images: []
---

JavaScript ä¸­æ²¡æœ‰å†…ç½®ä¼˜å…ˆé˜Ÿåˆ—è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œéœ€è¦è‡ªå·±æ¥å®ç°ä¸€ä¸‹~ğŸ‘»

```javascript
class PriorityQueue {
    constructor(data = [], compare) {
        this.queue = data
        this.compare = compare
        for (let i = this.queue.length >> 1; i >= 0; --i) this.down(i)
    }
    up(i) {
        while (i > 0) {
            const parent = (i - 1) >> 1
            if (this.compare(this.queue[parent], this.queue[i])) {
                this.swap(i, parent)
                i = parent
            } else {
                break
            }
        }
    }
    down(i) {
        while (i < this.size() >> 1) {
            let leftIndex = 2 * i + 1
            let rightIndex = leftIndex + 1

            let temp = i
            if (this.compare(this.queue[temp], this.queue[leftIndex])) {
                temp = leftIndex
            }
            if (this.compare(this.queue[temp], this.queue[rightIndex])) {
                temp = rightIndex
            }
            if (i !== temp) {
                this.swap(i, temp)
                i = temp
            } else {
                break
            }
        }
    }
    peek() {
        return this.queue[0]
    }
    push(val) {
        this.up(this.queue.push(val) - 1)
    }
    pop() {
        this.swap(0, this.size() - 1)
        const top = this.queue.pop()
        this.down(0)
        return top
    }
    size() {
        return this.queue.length
    }
    swap(i, j) {
        const temp = this.queue[i]
        this.queue[i] = this.queue[j]
        this.queue[j] = temp
    }
}
```

æµ‹è¯•ï¼š

```js
const pq = new PriorityQueue([4, 2, 3, 5, 6, 1, 7, 8, 9], (a, b) => a - b > 0)
console.log('ğŸ“ŒğŸ“ŒğŸ“Œ ~ pq', pq)
console.log(pq.poll())
console.log(pq.poll())
console.log(pq.poll())
pq.push(10)
pq.push(20)
console.log(pq.poll())
console.log(pq.poll())
console.log(pq.poll())
console.log(pq.poll())
```

---

é€’å½’ç‰ˆæœ¬çš„ downï¼Œupï¼Œå¦å¤–ä½¿ç”¨äº†å †é¡¶å®ˆå«ç®€åŒ–

- ç²¾é«“ä¹‹ä¸€ï¼š**æ•°ç»„çš„ç¬¬ä¸€ä¸ªç´¢å¼• 0 ç©ºç€ä¸ç”¨**
- ç²¾é«“ä¹‹äºŒï¼šæ’å…¥æˆ–è€…åˆ é™¤å…ƒç´ çš„æ—¶å€™ï¼Œéœ€è¦å…ƒç´ è‡ªåŠ¨æ’åº

```js
class PriorityQueue {
    constructor(data, cmp) {
        // ä½¿ç”¨å †é¡¶å®ˆå«ï¼Œæ›´æ–¹ä¾¿ä¸Šæµ®æ—¶çˆ¶èŠ‚ç‚¹çš„è·å– p = i >> 1, å­èŠ‚ç‚¹æœ¬èº«å°±æ¯”è¾ƒå¥½è·å–å€’æ˜¯æ— æ‰€è°“
        this.data = [null, ...data]
        this.cmp = cmp
        for (let i = this.data.length >> 1; i > 0; --i) this.down(i) // å¯¹é™¤æœ€åä¸€å±‚çš„å­èŠ‚ç‚¹è¿›è¡Œå †åŒ–åˆå§‹åŒ–
    }
    get size() {
        return this.data.length - 1
    }
    swap(i, j) {
        ;[this.data[i], this.data[j]] = [this.data[j], this.data[i]]
    }
    // é€’å½’ä¸Šæµ®å’Œä¸‹æ²‰
    down(i) {
        if (i === this.size) return
        const j = i
        const l = i << 1
        const r = l + 1
        if (l <= this.size && this.cmp(this.data[i], this.data[l])) i = l
        if (l <= this.size && this.cmp(this.data[i], this.data[r])) i = r
        if (i !== j) {
            this.swap(i, j)
            this.down(i)
        }
    }
    up(i) {
        if (i === 1) return
        const p = i >> 1
        if (this.cmp(this.data[p], this.data[i])) {
            this.swap(p, i)
            this.up(p)
        }
    }
    push(val) {
        this.up(this.data.push(val) - 1) // åŠ å…¥é˜Ÿåˆ—åè¿›è¡Œä¸Šæµ®å¤„ç†
    }
    poll() {
        this.swap(1, this.size) // å…ˆäº¤æ¢é¦–å°¾ï¼Œæ–¹ä¾¿åé¢å‡ºé˜Ÿ
        const top = this.data.pop()
        this.down(1)
        return top
    }
}
```

ä½¿ç”¨åœºæ™¯ï¼š

- lc.23 åˆå¹¶ K ä¸ªæœ‰åºé“¾è¡¨
- å †æ’åºä¹Ÿæœ‰å…¶ä¸­çš„æ€æƒ³
